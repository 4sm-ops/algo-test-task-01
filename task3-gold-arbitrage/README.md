# Task 3: Gold Futures Arbitrage Strategy

## –û–ø–∏—Å–∞–Ω–∏–µ

–ê—Ä–±–∏—Ç—Ä–∞–∂–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –º–µ–∂–¥—É —Ñ—å—é—á–µ—Ä—Å–∞–º–∏ –Ω–∞ –∑–æ–ª–æ—Ç–æ –Ω–∞ –±–∏—Ä–∂–∞—Ö B3 (–ë—Ä–∞–∑–∏–ª–∏—è) –∏ MOEX (–†–æ—Å—Å–∏—è).

## –°—Ç–∞—Ç—É—Å

üî¥ **–°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–±—ã—Ç–æ—á–Ω–∞** ‚Äî —à–∏—Ä–æ–∫–∏–π —Å–ø—Ä–µ–¥ –Ω–∞ B3 (~26 –ø—É–Ω–∫—Ç–æ–≤) –¥–µ–ª–∞–µ—Ç –∞—Ä–±–∏—Ç—Ä–∞–∂ –Ω–µ–≤—ã–≥–æ–¥–Ω—ã–º.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
cd task3-gold-arbitrage
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
python main.py
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –°–¥–µ–ª–æ–∫ | 1,590 |
| Win rate | 0.9% |
| Net PnL | -42,052 –ø—É–Ω–∫—Ç–æ–≤ |
| Sharpe | -20.84 |
| Margin per trade | $517 |
| ROI on margin | -8,134% |

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `config.py` —á–µ—Ä–µ–∑ dataclass `StrategyConfig`.

### –¢–æ—Ä–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `symbol_b3` | `GLDG26` | –¢–∏–∫–µ—Ä —Ñ—å—é—á–µ—Ä—Å–∞ –Ω–∞ –∑–æ–ª–æ—Ç–æ –Ω–∞ B3 |
| `symbol_moex` | `GOLD-3.26` | –¢–∏–∫–µ—Ä —Ñ—å—é—á–µ—Ä—Å–∞ –Ω–∞ –∑–æ–ª–æ—Ç–æ –Ω–∞ MOEX |

### –ü–æ—Ä–æ–≥–∏ Z-score

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `entry_threshold` | 2.0 œÉ | –í—Ö–æ–¥ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ Z-score –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ |
| `exit_threshold` | 0.5 œÉ | –í—ã—Ö–æ–¥ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ Z-score –∫ —Å—Ä–µ–¥–Ω–µ–º—É |
| `stop_loss_threshold` | 4.0 œÉ | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ (—Å—Ç–æ–ø-–ª–æ—Å—Å) |
| `zscore_window` | 1000 —Ç–∏–∫–æ–≤ | –û–∫–Ω–æ rolling-—Ä–∞—Å—á—ë—Ç–∞ Z-score |

### –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `position_size` | 1 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–π –Ω–æ–≥–µ |

### –ò–∑–¥–µ—Ä–∂–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `commission_per_contract` | 0.10 BRL | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è –∑–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç |

### –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `max_positions` | 1 | –ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π |
| `min_liquidity` | 1.0 | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º –Ω–∞ bid/ask –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ |

### Latency (–∑–∞–¥–µ—Ä–∂–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `b3_latency_ms` | 250 –º—Å | –ó–∞–¥–µ—Ä–∂–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ B3 (MOEX = 0 –º—Å) |

### –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–ì–û)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `margin_b3` | $217 | –ì–û –Ω–∞ B3 (~1,300 BRL) |
| `margin_moex` | $300 | –ì–û –Ω–∞ MOEX (~30,000 ‚ÇΩ) |

**–ò—Ç–æ–≥–æ –Ω–∞ —Å–¥–µ–ª–∫—É:** $517 (B3 + MOEX)

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from config import StrategyConfig, DEFAULT_STRATEGY_CONFIG

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
config = DEFAULT_STRATEGY_CONFIG

# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
custom_config = StrategyConfig(
    entry_threshold=3.0,  # –±–æ–ª–µ–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –≤—Ö–æ–¥
    zscore_window=500,    # –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–∫–Ω–æ
    b3_latency_ms=100,    # –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
)
```

## –î–∞–Ω–Ω—ã–µ

**–§–∞–π–ª:** `quotes_202512260854-GOLD.csv`

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| ts | Timestamp (–Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥—ã) |
| symbol | `GLDG26` (B3) –∏–ª–∏ `GOLD-3.26` (MOEX) |
| bid_price | –õ—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ |
| bid_qty | –û–±—ä—ë–º bid |
| ask_price | –õ—É—á—à–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ |
| ask_qty | –û–±—ä—ë–º ask |

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- –ü–µ—Ä–∏–æ–¥: 2025-11-24 ‚Äî 2025-12-09
- –°—Ç—Ä–æ–∫: 498,188
- B3 avg spread: **26.34** –ø—É–Ω–∫—Ç–æ–≤
- MOEX avg spread: **2.22** –ø—É–Ω–∫—Ç–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
task3-gold-arbitrage/
‚îú‚îÄ‚îÄ config.py              # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îú‚îÄ‚îÄ main.py                # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ strategy.md            # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py     # –ó–∞–≥—Ä—É–∑–∫–∞ CSV
‚îÇ   ‚îú‚îÄ‚îÄ indicators.py      # –°–ø—Ä–µ–¥—ã –∏ Z-score
‚îÇ   ‚îú‚îÄ‚îÄ backtest.py        # –î–≤–∏–∂–æ–∫ –±—ç–∫—Ç–µ—Å—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ visualization.py   # Plotly –≥—Ä–∞—Ñ–∏–∫–∏
‚îî‚îÄ‚îÄ output/
    ‚îú‚îÄ‚îÄ backtest_report.md
    ‚îú‚îÄ‚îÄ backtest_results.png
    ‚îú‚îÄ‚îÄ trades.csv
    ‚îú‚îÄ‚îÄ equity_interactive.html
    ‚îî‚îÄ‚îÄ strategy_dashboard.html
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –†–∞—Å—á—ë—Ç —Å–ø—Ä–µ–¥–∞ –ø–æ tradeable —Ü–µ–Ω–∞–º
```python
spread_long = ask_b3 - bid_moex   # –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Å–ø—Ä–µ–¥–∞
spread_short = bid_b3 - ask_moex  # –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ —Å–ø—Ä–µ–¥–∞
```

### –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ latency
- **MOEX**: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
- **B3**: –∑–∞–¥–µ—Ä–∂–∫–∞ 250 –º—Å ‚Äî –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ —Ü–µ–Ω–µ —á–µ—Ä–µ–∑ N —Ç–∏–∫–æ–≤ –ø–æ—Å–ª–µ —Å–∏–≥–Ω–∞–ª–∞

### –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- B3: ~$217 (~1,300 BRL) ‚Äî [–∏—Å—Ç–æ—á–Ω–∏–∫](https://clientes.b3.com.br/en/w/launch-of-new-gold-futures-contract)
- MOEX: ~$300 (~30,000 ‚ÇΩ) ‚Äî [–∏—Å—Ç–æ—á–Ω–∏–∫](https://smart-lab.ru/q/futures/GDH6/)

## –ü—Ä–∏—á–∏–Ω—ã —É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏

1. **–®–∏—Ä–æ–∫–∏–π —Å–ø—Ä–µ–¥ B3** (~26 –ø—Ç vs ~2 –ø—Ç –Ω–∞ MOEX) ‚Äî –∫–∞–∂–¥–∞—è —Å–¥–µ–ª–∫–∞ —Ç–µ—Ä—è–µ—Ç –Ω–∞ crossing the spread
2. **Latency B3** (250 –º—Å) ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π slippage
3. **–ê—Å–∏–º–º–µ—Ç—Ä–∏—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏** ‚Äî –∞—Ä–±–∏—Ç—Ä–∞–∂ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `pandas` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- `numpy` ‚Äî —Ä–∞—Å—á—ë—Ç—ã
- `matplotlib` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏
- `plotly` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã
